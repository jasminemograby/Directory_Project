# Supabase Migration Fix - current_role and value_proposition

## âŒ ×”×‘×¢×™×”

×‘-Supabase, `ADD COLUMN IF NOT EXISTS` ×œ× ×ª××™×“ × ×ª××š. ×§×™×‘×œ×ª ×©×’×™××”:
```
ERROR: 42601: syntax error at or near "current_role"
```

## âœ… ×”×¤×ª×¨×•×Ÿ

×”×©×ª××© ×‘-SQL script ×”×‘× ×©××©×ª××© ×‘-`DO $$ BEGIN ... END $$;` block:

```sql
-- Add current_role column if it doesn't exist
DO $$
BEGIN
    IF NOT EXISTS (
        SELECT 1 FROM information_schema.columns 
        WHERE table_name = 'employees' AND column_name = 'current_role'
    ) THEN
        ALTER TABLE employees ADD COLUMN current_role VARCHAR(255);
    END IF;
END $$;

-- Add value_proposition column if it doesn't exist
DO $$
BEGIN
    IF NOT EXISTS (
        SELECT 1 FROM information_schema.columns 
        WHERE table_name = 'employees' AND column_name = 'value_proposition'
    ) THEN
        ALTER TABLE employees ADD COLUMN value_proposition TEXT;
    END IF;
END $$;

-- Add comments
COMMENT ON COLUMN employees.current_role IS 'Current role of the employee in the company (filled during company registration)';
COMMENT ON COLUMN employees.target_role IS 'Target role for career progression (filled during company registration)';
COMMENT ON COLUMN employees.value_proposition IS 'AI-generated value proposition based on current_role and target_role (generated by Gemini)';
```

## ğŸ“‹ ×”×•×¨××•×ª

1. ×¤×ª×— ××ª Supabase Dashboard
2. ×œ×š ×œ-SQL Editor
3. ×”×¢×ª×§ ×•×”×“×‘×§ ××ª ×”-SQL script ×œ××¢×œ×”
4. ×œ×—×¥ Run
5. ×•×“× ×©×”×¢××•×“×•×ª × ×•×¡×¤×• ×‘×”×¦×œ×—×”

## âœ… ××™××•×ª

×œ××—×¨ ×”×¨×¦×ª ×”-migration, ×ª×•×›×œ ×œ×‘×“×•×§ ×©×”×¢××•×“×•×ª × ×•×¡×¤×•:

```sql
SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'employees' 
AND column_name IN ('current_role', 'value_proposition');
```

×¦×¨×™×š ×œ×¨××•×ª:
- `current_role` - `character varying`
- `value_proposition` - `text`

